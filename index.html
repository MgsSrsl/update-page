<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî –°–∫–ª–∞–¥—Å–±–æ—Ä–∫–∞</title>
  <style>
    :root{
      --glass-bg: rgba(255,255,255,.1);
      --glass-stroke: rgba(255,255,255,.2);
      --panel-bg: rgba(255,255,255,.08);
      --text: #eee;
      --muted: #bbb;
      --accent: #ff5252;
      --accent-2: #ff8a80;
      --shadow: 0 4px 20px rgba(0,0,0,.3);
    }
    /* –§–æ–Ω */
    body {
      background-image: url("https://img.goodfon.ru/wallpaper/nbig/6/be/priroda-igry-peizazhi-igra-game-landscape-nature-castle-sred.webp");
      background-size: cover; background-position: center; background-repeat: no-repeat;
      min-height: 100vh; margin: 0; color: var(--text); font-family: "Segoe UI", system-ui, sans-serif;
      display: grid; place-items: start center; padding: 40px 20px 100px; box-sizing: border-box;
    }
    /* –¢–µ–Ω—å/–¥–∏–º–º–µ—Ä –ø–æ–¥ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º */
    body::before { content: ""; position: fixed; inset: 0; background: rgba(0,0,0,.6); z-index: 0; }

    /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü */
    .wrap { position: relative; z-index: 1; width: min(720px, 100%); }

    h1 { color: var(--accent); font-size: 28px; margin: 0 0 10px; text-align: center; }
    p#versionLine { color: #ddd; margin: 0 0 22px; text-align: center; }

    /* –ë–ª–æ–∫ "–ß—Ç–æ –Ω–æ–≤–æ–≥–æ" */
    .changelog {
      background: var(--glass-bg); backdrop-filter: blur(6px);
      border: 1px solid var(--glass-stroke); border-radius: 12px;
      padding: 18px 20px; box-shadow: var(--shadow); color: var(--text);
    }
    .changelog h2 { font-size: 18px; color: var(--accent-2); margin: 0 0 10px; text-align: center; }
    .changelog h3 { font-size: 16px; margin: 14px 0 6px; color: #ffd1ce; }
    .changelog ul { margin: 0 0 6px 18px; padding: 0; line-height: 1.5; }
    .changelog li { margin: 4px 0; }

    /* –ö–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ APK */
    .download-btn {
      display: inline-block; margin: 18px auto 34px; text-decoration: none; text-align: center;
      background: #d32f2f; color: #fff; font-weight: 700; font-size: 18px; padding: 14px 36px;
      border-radius: 10px; box-shadow: 0 0 15px rgba(211,47,47,.4); transition: background .25s, transform .1s;
    }
    .download-btn:hover { background: #b71c1c; transform: translateY(-2px); }

    footer { text-align: center; font-size: 13px; color: var(--muted); margin-top: 8px; }

    /* –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å –≤–µ—Ä—Å–∏–π */
    .versions-panel {
      position: fixed; right: 20px; top: 100px; width: 320px; max-height: 70vh; overflow-y: auto;
      background: var(--panel-bg); border: 1px solid var(--glass-stroke); backdrop-filter: blur(8px);
      border-radius: 12px; padding: 12px 14px; box-shadow: var(--shadow); color: #fff; z-index: 2;
    }
    .versions-panel h2 { font-size: 16px; color: var(--accent-2); text-align: center; margin: 0 0 8px; user-select: none; }
    .versions-panel h3 { font-size: 15px; color: #ffd1ce; margin: 4px 0 8px; }
    .old-version { position: relative; border-top: 1px solid var(--glass-stroke); padding-top: 10px; margin-top: 10px; }
    .old-version strong { display: block; margin-bottom: 6px; color: #ffd1ce; }
    .old-version ul { margin: 0 0 6px 18px; padding: 0; }
    #latest-list { margin-bottom: 6px; }
    #history-toggle { font-size: 14px; color: #fff; opacity: .9; cursor: pointer; user-select: none; padding: 8px 0; text-align: center; }
    #history-toggle::after { content: " ‚ñº"; font-size: 12px; opacity: .8; }
    #history-list.collapsed { display: none; }

    /* –£–ø—Ä–∞–≤–ª—è—é—â–∏–µ –∫–Ω–æ–ø–∫–∏ —Å–ª–µ–≤–∞ –≤–Ω–∏–∑—É, —Å ‚Äú–∫–∞—Ä–º–∞–Ω–æ–º‚Äù, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç */
    .fab { position: fixed; left: 20px; z-index: 3; border: 0; border-radius: 12px; color: #fff;
           font-weight: 700; font-size: 15px; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,.4);
           padding: 10px 16px; }
    #exportBtn { bottom: 88px; background: #2e7d32; }
    #addReleaseBtn { bottom: 36px; background: var(--accent); }
    #gearBtn {
      position: fixed; left: 20px; bottom: 36px; width: 48px; height: 48px; border-radius: 50%;
      border: none; background: rgba(255,255,255,0.15); color: #fff; font-size: 22px; cursor: pointer; z-index: 4;
      backdrop-filter: blur(6px); transition: transform 0.25s, background 0.25s;
      display: grid; place-items: center;
    }
    #gearBtn:hover { background: rgba(255,255,255,0.3); transform: rotate(45deg); }
    /* –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ */
    .fab, #gearBtn { opacity: 1; }
    .fab.hidden { opacity: 0; pointer-events: none; transform: translateY(6px); transition: .25s; }
    .fab.visible { opacity: 1; transform: translateY(0); transition: .25s; }

    /* –ú–æ–¥–∞–ª–∫–∏ */
    .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,.7); z-index: 1000; align-items: center; justify-content: center; }
    .modal-card { background: #222; padding: 24px; border-radius: 12px; max-width: 640px; width: 92%; box-shadow: 0 4px 20px rgba(0,0,0,.5); color: #fff; }
    .modal .actions { display: flex; gap: 10px; flex-wrap: wrap; }
    .btn { border: none; border-radius: 8px; color: #fff; padding: 10px 14px; font-weight: 700; cursor: pointer; }
    .btn-primary { background: var(--accent); }
    .btn-secondary { background: #555; }
    .btn-copy { background: #1976d2; }
    .btn-danger { background: #b71c1c; }
    input, textarea { width: 100%; margin: 6px 0 12px; padding: 10px; border-radius: 8px; border: 1px solid #444; background: #111; color: #fff; }
    textarea#resultArea, textarea#fullIndexArea { height: 220px; }

    /* –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —É–¥–∞–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ª–∏–∑–∞ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
    .ov-tools { position: absolute; top: 6px; right: 0; display: none; gap: 6px; }
    .ov-btn { border: 1px solid rgba(255,255,255,.3); background: rgba(0,0,0,.35); color: #fff; font-size: 12px; padding: 4px 8px; border-radius: 8px; cursor: pointer; backdrop-filter: blur(4px); }
    body.edit-mode .old-version:hover .ov-tools { display: inline-flex; }

    /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è ‚Äî –ø–∞–Ω–µ–ª—å —É–µ–∑–∂–∞–µ—Ç –ø–æ–¥ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫, –∫–Ω–æ–ø–∫–∏ –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—Ç */
    @media (max-width: 980px) {
      .versions-panel { position: static; width: auto; max-width: 720px; margin: 14px auto 0; }
      #gearBtn { left: auto; right: 20px; bottom: 20px; }
      #exportBtn { left: auto; right: 20px; bottom: 84px; }
      #addReleaseBtn { left: auto; right: 20px; bottom: 36px; }
      body { padding-bottom: 140px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1 id="mainH1">–î–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ üì¶</h1>
    <p id="versionLine">–í–µ—Ä—Å–∏—è 1.4 –æ—Ç 20 –æ–∫—Ç—è–±—Ä—è 2025</p>

    <div class="changelog" id="mainChangelogBlock">
      <h2>–ß—Ç–æ –Ω–æ–≤–æ–≥–æ</h2>
      <!-- —Å—é–¥–∞ JS –ø–æ–ª–æ–∂–∏—Ç —Å–µ–∫—Ü–∏–∏ —Å h3 –∏ —Å–ø–∏—Å–∫–∞–º–∏ -->
      <div id="mainChangelog"></div>
    </div>

    <a class="download-btn" id="downloadA" href="https://apk-download-gamma.vercel.app/app-release.apk" download>‚¨á –°–∫–∞—á–∞—Ç—å APK</a>
    <footer>MgsINC ¬© <span id="year">2025</span></footer>
  </div>

  <aside class="versions-panel" id="versionsPanel">
    <h2 id="historyTitle">üìú –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π</h2>
    <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ–ª–∏–∑—ã</h3>

    <div id="latest-list">
      <!-- –ø—Ä–∏–º–µ—Ä —Å–≤–µ–∂–µ–≥–æ —Ä–µ–ª–∏–∑–∞ -->
      <div class="old-version">
        <strong>–í–µ—Ä—Å–∏—è 1.3.1 ‚Äî 20 –æ–∫—Ç—è–±—Ä—è 2025</strong>
        <ul>
          <li>üî• HotFix</li>
          <li>üë∑ –£ –∫–ª–∞–¥–æ–≤—â–∏–∫–∞</li>
          <li>üîÅ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á ‚Äî –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º –º–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ (–µ—Å—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è).</li>
          <li>‚ö†Ô∏è –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.</li>
          <li>üßë‚Äçüíº –£ –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞</li>
          <li>üì¶ –¢–µ–ø–µ—Ä—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–∞–º–æ–≤—ã–≤–æ–∑–∞—Ö –ø—Ä–∏—Ö–æ–¥—è—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</li>
          <li>üí¨ –£ –º–µ–Ω–µ–¥–∂–µ—Ä–∞</li>
          <li>üîî –û–±—Ä–∞—Ç–Ω—ã–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö (–≤–æ–∑–≤—Ä–∞—Ç—ã, –∑–∞–∫–∞–∑—ã –Ø–Ω–¥–µ–∫—Å) –¥–ª—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è.</li>
          <li>üåê –£ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</li>
          <li>üü¢ –ò–Ω–¥–∏–∫–∞—Ü–∏—è —Å–≤—è–∑–∏: ¬´–í —Å–µ—Ç–∏¬ª (–∑–µ–ª—ë–Ω–∞—è), ¬´–ü–ª–æ—Ö–∞—è —Å–≤—è–∑—å¬ª (–∂—ë–ª—Ç–∞—è), –ø—Ä–∏ –ø–æ–ª–Ω–æ–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ ‚Äî –≤—Å–ø–ª—ã–≤–∞—é—â–∏–π –±–∞–Ω–Ω–µ—Ä –ø—Ä–æ Wi-Fi –≤ –≤–∞–≥–æ–Ω—á–∏–∫–µ.</li>
          <li>üñºÔ∏è –§–æ—Ç–æ –≤ –∑–∞–¥–∞—á–µ —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø—Ä–æ–ª–∏—Å—Ç—ã–≤–∞—Ç—å (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª).</li>
          <li>‚è±Ô∏è –í –∑–∞–¥–∞—á–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è, –≤–∑—è—Ç–∏—è –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.</li>
        </ul>
      </div>

      <div class="old-version">
        <strong>–í–µ—Ä—Å–∏—è 1.3.1 ‚Äî 16 –æ–∫—Ç—è–±—Ä—è 2025</strong>
        <ul>
          <li>üñ®Ô∏è –ü–µ—á–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ —Ñ–∞–π–ª–∞ –ø—Ä—è–º–æ –∏–∑ –∑–∞–¥–∞—á–∏.</li>
          <li>üñºÔ∏è –ò–Ω–¥–∏–∫–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∑–∞–¥–∞—á–∏.</li>
          <li>üóÉÔ∏è –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∞—Ä—Ö–∏–≤–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –∑–∞–¥–∞—á.</li>
          <li>üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ –∑–∞–¥–∞—á–∏.</li>
          <li>üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ ¬´–∫–∞—Ä–∞–Ω–¥–∞—à / –ø—Ä–∏–±–ª–∏–∑–∏—Ç—å¬ª.</li>
        </ul>
      </div>
    </div>

    <div id="history-toggle">–û—Å—Ç–∞–ª—å–Ω—ã–µ</div>
    <div id="history-list" class="collapsed">
      <div class="old-version">
        <strong>–í–µ—Ä—Å–∏—è 1.3 ‚Äî 12 –æ–∫—Ç—è–±—Ä—è 2025</strong>
        <ul>
          <li>üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–¥–∞—á–∏ ‚Äî —Ç–µ–ø–µ—Ä—å –≤—Å—è –æ–±–ª–∞—Å—Ç—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞.</li>
          <li>üóÉÔ∏è –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∞—Ä—Ö–∏–≤–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –∑–∞–¥–∞—á.</li>
          <li>üñºÔ∏è –ò–Ω–¥–∏–∫–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∑–∞–¥–∞—á–∏.</li>
        </ul>
      </div>
      <div class="old-version">
        <strong>–í–µ—Ä—Å–∏—è 1.1 ‚Äî 6 –æ–∫—Ç—è–±—Ä—è 2025</strong>
        <ul>
          <li>‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω –¥–∏–∑–∞–π–Ω –∫–∞—Ä—Ç–æ—á–µ–∫ –∏ —Ñ–æ–Ω–∞.</li>
          <li>üì± –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π Android.</li>
        </ul>
      </div>
      <div class="old-version">
        <strong>–í–µ—Ä—Å–∏—è 1 ‚Äî 1 –∞–≤–≥—É—Å—Ç–∞ 2025</strong>
        <ul><li>üß© –Ø —Ä–æ–¥–∏–ª—Å—è.</li></ul>
      </div>
    </div>
  </aside>

  <!-- FAB-–∫–Ω–æ–ø–∫–∏; –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç—ã –∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ –∫–ª–∏–∫—É –Ω–∞ ‚öôÔ∏è -->
  <button id="gearBtn" title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–ª–∏–∑–∞–º–∏">‚öôÔ∏è</button>
  <button id="exportBtn" class="fab hidden">üìÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å index.html</button>
  <button id="addReleaseBtn" class="fab hidden">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–ª–∏–∑</button>

  <!-- –ú–æ–¥–∞–ª–∫–∏ -->
  <div class="modal" id="addModal">
    <div class="modal-card">
      <h2 id="addModalTitle">–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–ª–∏–∑</h2>
      <label>–í–µ—Ä—Å–∏—è:</label>
      <input id="relVer" placeholder="1.4.1">
      <label>–î–∞—Ç–∞:</label>
      <input id="relDate" placeholder="20 –æ–∫—Ç—è–±—Ä—è 2025">
      <label>–ò–∑–º–µ–Ω–µ–Ω–∏—è (–ø–æ —Å—Ç—Ä–æ–∫–∞–º):</label>
      <textarea id="relNotes" placeholder="üë∑ –£ –∫–ª–∞–¥–æ–≤—â–∏–∫–∞
üîÅ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è...
üßë‚Äçüíº –£ –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞
üì¶ –¢–µ–ø–µ—Ä—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è..."></textarea>
      <div class="actions">
        <button class="btn btn-primary" id="saveRelease">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button class="btn btn-danger" id="deleteRelease" style="display:none;">–£–¥–∞–ª–∏—Ç—å —Ä–µ–ª–∏–∑</button>
        <button class="btn btn-secondary" id="closeAdd">–û—Ç–º–µ–Ω–∞</button>
      </div>
      <div id="resultBlock" style="display:block;">
        <p>HTML –±–ª–æ–∫–∞ —Ä–µ–ª–∏–∑–∞:</p>
        <textarea id="resultArea" readonly></textarea>
      </div>
    </div>
  </div>

  <div class="modal" id="exportModal">
    <div class="modal-card">
      <h2>–ì–æ—Ç–æ–≤—ã–π index.html</h2>
      <textarea id="fullIndexArea" readonly></textarea>
      <div class="actions">
        <button class="btn btn-copy" id="copyIndex">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
        <button class="btn btn-secondary" id="closeExport">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

<script>
(function(){
  const $id = (id) => document.getElementById(id);
  const qs  = (sel) => document.querySelector(sel);
  const qsa = (sel) => Array.from(document.querySelectorAll(sel));

  $id('year').textContent = new Date().getFullYear();

  // –¢–æ–≥–≥–ª "–û—Å—Ç–∞–ª—å–Ω—ã–µ"
  function toggleHistory(){
    $id('history-list').classList.toggle('collapsed');
  }
  $id('historyTitle').onclick = toggleHistory;
  $id('history-toggle').onclick = toggleHistory;

  // ====== –ì–†–£–ü–ü–ò–†–û–í–ö–ê –ù–û–¢–ê–¶–ò–ô –í –°–ï–ö–¶–ò–ò ======
  // –õ–∏–Ω–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–º —Å–µ–∫—Ü–∏–∏, –µ—Å–ª–∏:
  // 1) –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –æ–¥–Ω–æ–≥–æ –∏–∑ —ç–º–æ–¥–∑–∏ —Ä–æ–ª–µ–π, –ò/–ò–õ–ò
  // 2) –æ–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ "–£ –∫–ª–∞–¥–æ–≤—â–∏–∫–∞", "–£ –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞", "–£ –≤—Å–µ—Ö", "–£ –º–µ–Ω–µ–¥–∂–µ—Ä–∞" (–±–µ–∑ —Ç–æ—á–∫–∏)
  const sectionEmoji = ['üë∑','üßë‚Äçüíº','üåê','üí¨'];
  const sectionWords = ['–£ –∫–ª–∞–¥–æ–≤—â–∏–∫–∞','–£ –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞','–£ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π','–£ –≤—Å–µ—Ö','–£ –º–µ–Ω–µ–¥–∂–µ—Ä–∞'];

  function isSectionHeader(line){
    const s = line.trim();
    if (!s) return false;
    if (sectionEmoji.some(e => s.startsWith(e))) return true;
    if (sectionWords.some(w => s === w)) return true;
    // –¢–∞–∫–∂–µ –µ—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –∫–æ—Ä–æ—Ç–∫–∞—è (<= 30) –∏ –±–µ–∑ —Ç–æ—á–∫–∏ –≤ –∫–æ–Ω—Ü–µ ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫
    if (s.length <= 30 && !/[.!?]$/.test(s)) return true;
    return false;
  }

  // –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫ (li) –∏–∑ –±–ª–æ–∫–∞ —Ä–µ–ª–∏–∑–∞ –≤ HTML —Å–µ–∫—Ü–∏–∏ h3 + ul
  function buildSectionsFromLis(liNodes){
    const sections = [];
    let current = { title: null, items: [] };

    liNodes.forEach(li => {
      const text = li.innerHTML.trim();
      if (isSectionHeader(text)){
        // –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å–µ–∫—Ü–∏—é, –µ—Å–ª–∏ –±—ã–ª–∞ —Å –ø—É–Ω–∫—Ç–∞–º–∏
        if (current.title || current.items.length){
          sections.push(current);
        }
        current = { title: text.replace(/^[-‚Ä¢\s]+/, ''), items: [] };
      } else {
        current.items.push(text);
      }
    });
    if (current.title || current.items.length){
      sections.push(current);
    }

    // –†–µ–Ω–¥–µ—Ä
    const frag = document.createDocumentFragment();
    sections.forEach(sec => {
      if (sec.title) {
        const h3 = document.createElement('h3');
        h3.innerHTML = sec.title;
        frag.appendChild(h3);
      }
      if (sec.items.length){
        const ul = document.createElement('ul');
        sec.items.forEach(it => {
          const li = document.createElement('li');
          li.innerHTML = it;
          ul.appendChild(li);
        });
        frag.appendChild(ul);
      }
    });
    return frag;
  }

  // –†–∞–∑–±–æ—Ä "–í–µ—Ä—Å–∏—è X ‚Äî –î–∞—Ç–∞"
  function parseStrong(str){
    const m = /^–í–µ—Ä—Å–∏—è\s+(.+?)\s+‚Äî\s+(.+)$/.exec((str||'').trim());
    return m ? { ver: m[1], date: m[2] } : { ver: '', date: '' };
  }

  // –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å–∞–º—ã–π —Å–≤–µ–∂–∏–π —Ä–µ–ª–∏–∑ –≤ –≥–ª–∞–≤–Ω—ã–π –±–ª–æ–∫ (—Å —Å–µ–∫—Ü–∏—è–º–∏)
  function updateMainFromLatest(){
    const first = qs('#latest-list .old-version');
    if (!first) return;

    const meta  = parseStrong(first.querySelector('strong')?.textContent || '');
    const lis   = Array.from(first.querySelectorAll('ul > li'));

    const target = $id('mainChangelog');
    target.innerHTML = '';
    target.appendChild(buildSectionsFromLis(lis));

    if (meta.ver && meta.date){
      $id('versionLine').textContent = `–í–µ—Ä—Å–∏—è ${meta.ver} –æ—Ç ${meta.date}`;
    }
  }

  // –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤ latest —Ç–æ–ª—å–∫–æ –¥–≤–∞ —Ä–µ–ª–∏–∑–∞ ‚Äî –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–∫–∏–Ω—É—Ç—å –≤ history
  function normalizeLatestLimit(){
    const latest = qsa('#latest-list .old-version');
    const historyList = $id('history-list');
    if (latest.length > 2){
      latest.slice(2).forEach(node => historyList.insertBefore(node, historyList.firstChild));
    }
  }

  // ===== –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (—à–µ—Å—Ç–µ—Ä—ë–Ω–∫–∞) =====
  const gear = $id('gearBtn');
  const addBtn = $id('addReleaseBtn');
  const expBtn = $id('exportBtn');
  let panelOpen = false;

  function setFabVisibility(open){
    [addBtn, expBtn].forEach(btn => btn.classList.toggle('hidden', !open));
    [addBtn, expBtn].forEach(btn => btn.classList.toggle('visible', open));
    document.body.classList.toggle('edit-mode', open);
  }

  gear.addEventListener('click', () => {
    panelOpen = !panelOpen;
    setFabVisibility(panelOpen);
  });

  // ===== –ú–æ–¥–∞–ª–∫–∏ =====
  const addModal = $id('addModal');
  const exportModal = $id('exportModal');
  const relVer = $id('relVer');
  const relDate = $id('relDate');
  const relNotes = $id('relNotes');
  const resultArea = $id('resultArea');

  $id('closeAdd').onclick   = () => addModal.style.display = 'none';
  $id('closeExport').onclick= () => exportModal.style.display = 'none';
  $id('exportBtn').onclick  = () => {
    $id('fullIndexArea').value = document.documentElement.outerHTML;
    exportModal.style.display = 'flex';
  };
  $id('copyIndex').onclick  = () => { $id('fullIndexArea').select(); document.execCommand('copy'); };

  $id('addReleaseBtn').onclick = () => {
    const d = new Date();
    const months = ['—è–Ω–≤–∞—Ä—è','—Ñ–µ–≤—Ä–∞–ª—è','–º–∞—Ä—Ç–∞','–∞–ø—Ä–µ–ª—è','–º–∞—è','–∏—é–Ω—è','–∏—é–ª—è','–∞–≤–≥—É—Å—Ç–∞','—Å–µ–Ω—Ç—è–±—Ä—è','–æ–∫—Ç—è–±—Ä—è','–Ω–æ—è–±—Ä—è','–¥–µ–∫–∞–±—Ä—è'];
    relDate.value = `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;
    relVer.value = '';
    relNotes.value = '';
    addModal.style.display = 'flex';
  };

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–ª–∏–∑–∞
  $id('saveRelease').onclick = () => {
    const ver = relVer.value.trim();
    const date = relDate.value.trim();
    const notes = relNotes.value.split('\n').map(s => s.trim()).filter(Boolean);
    if (!ver || !date || notes.length === 0){ alert('–ó–∞–ø–æ–ª–Ω–∏ –≤–µ—Ä—Å–∏—é, –¥–∞—Ç—É –∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –ø—É–Ω–∫—Ç.'); return; }

    const node = document.createElement('div');
    node.className = 'old-version';
    node.innerHTML = `<strong>–í–µ—Ä—Å–∏—è ${ver} ‚Äî ${date}</strong><ul>${notes.map(n => `<li>${n}</li>`).join('')}</ul>`;

    const latest = $id('latest-list');
    latest.insertBefore(node, latest.firstChild);

    // HTML –¥–ª—è –∫–æ–ø–∏–ø–∞—Å—Ç–∞
    resultArea.value = node.outerHTML;

    normalizeLatestLimit();
    updateMainFromLatest();
  };

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  normalizeLatestLimit();
  updateMainFromLatest();
})();
</script>
</body>
</html>

</html>

