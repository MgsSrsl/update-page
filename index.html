<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî –°–∫–ª–∞–¥—Å–±–æ—Ä–∫–∞</title>
  <style>
    :root{
      --glass-bg: rgba(255,255,255,0.1);
      --glass-stroke: rgba(255,255,255,0.2);
      --blur: 6px;
      --shadow: 0 4px 20px rgba(0,0,0,0.3);
      --accent: #ff5252;
      --accent-soft: #ff8a80;
      --text: #eee; --muted: #ccc;
    }
    *{box-sizing:border-box}
    body{
      background-image:url("https://img.goodfon.ru/wallpaper/nbig/6/be/priroda-igry-peizazhi-igra-game-landscape-nature-castle-sred.webp");
      background-size:cover;background-position:center;background-repeat:no-repeat;
      min-height:100vh;margin:0;font-family:"Segoe UI",system-ui,-apple-system,Arial,sans-serif;color:#fff;
      display:flex;flex-direction:column;align-items:center;text-align:center;overflow-y:auto;padding:40px 20px 80px;
    }
    body::before{content:"";position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:0}
    h1,p,a,footer,.changelog,.page-wrap,.versions-panel,.admin-panel{position:relative;z-index:1}
    .page-wrap{max-width:720px;width:100%}
    h1{color:var(--accent);font-size:28px;margin:0 0 10px}
    p{color:var(--muted);font-size:16px;margin:0 0 30px}
    .changelog{
      background:var(--glass-bg);backdrop-filter:blur(var(--blur));border:1px solid var(--glass-stroke);
      border-radius:12px;padding:18px 28px;max-width:720px;text-align:left;font-size:15px;color:var(--text);
      line-height:1.55;margin:0 auto 35px;box-shadow:var(--shadow)
    }
    .changelog h2{font-size:18px;color:var(--accent-soft);margin:0 0 12px;text-align:center}
    .list{list-style:none;margin:0;padding:0}
    .list>li{background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.16);border-radius:10px;padding:12px 14px;margin:10px 0}
    .title{font-weight:700;display:inline-block;margin-bottom:6px}
    .sub{margin:6px 0 0 0;padding-left:18px}.sub li{margin:4px 0}
    a.download-btn{
      background:#d32f2f;color:#fff;text-decoration:none;padding:14px 36px;border-radius:10px;
      font-size:18px;font-weight:600;transition:background .25s,transform .1s;box-shadow:0 0 15px rgba(211,47,47,.4);
      margin:10px auto 40px;display:inline-block
    }
    a.download-btn:hover{background:#b71c1c;transform:translateY(-2px)}
    footer{font-size:13px;color:#aaa;margin-top:auto}

    /* –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π */
    .versions-panel{
      position:fixed;right:20px;top:100px;width:320px;max-height:70vh;overflow-y:auto;background:rgba(255,255,255,0.08);
      border:1px solid var(--glass-stroke);backdrop-filter:blur(8px);border-radius:12px;padding:12px 18px;box-shadow:var(--shadow);
      color:#fff;font-size:14px;z-index:2;text-align:left
    }
    .versions-panel h2{font-size:16px;color:var(--accent-soft);margin:0 0 10px;text-align:center;cursor:pointer;user-select:none}
    .versions-panel h2::after{content:" ‚ñº";font-size:12px;opacity:.8}
    #history-list.collapsed{display:none}
    .old-version{margin:0 0 14px;border-top:1px solid rgba(255,255,255,.2);padding-top:10px;line-height:1.42}
    .old-version strong{display:block;margin-bottom:6px;color:#ffd1ce}
    .old-version ul{margin:6px 0 0 18px;padding:0}

    /* –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å */
    .gear{position:fixed;right:20px;bottom:20px;background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.25);
      width:52px;height:52px;border-radius:50%;display:flex;align-items:center;justify-content:center;
      backdrop-filter:blur(6px);cursor:pointer;box-shadow:var(--shadow);z-index:3}
    .gear:hover{background:rgba(255,255,255,.18)}
    .admin-panel{
      position:fixed;right:20px;bottom:88px;width:360px;max-width:92vw;background:rgba(0,0,0,.65);
      border:1px solid rgba(255,255,255,.25);border-radius:12px;padding:14px 14px 16px;box-shadow:var(--shadow);display:none
    }
    .admin-panel h3{margin:0 0 8px 0;font-size:16px;color:#fff}
    .admin-panel label{display:block;font-size:13px;color:#eee;margin:8px 0 4px}
    .admin-panel input,.admin-panel textarea,.admin-panel select{
      width:100%;border-radius:8px;border:1px solid rgba(255,255,255,.2);background:rgba(255,255,255,.08);color:#fff;
      padding:10px 12px;font-size:14px
    }
    .row{display:flex;gap:8px}
    .row>*{flex:1}
    .admin-actions{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
    .btn{
      background:#ff5252;border:none;color:#fff;padding:10px 14px;border-radius:9px;cursor:pointer;font-weight:600
    }
    .btn.secondary{background:rgba(255,255,255,.14)}
    .small{font-size:12px;color:#ccc;margin-top:4px}
    .inline{display:inline-block}
    @media (max-width:980px){
      .versions-panel{position:static;width:auto;max-width:720px;margin:10px auto 0}
      .page-wrap{max-width:720px}
    }
  </style>
</head>
<body>
  <div class="page-wrap">
    <h1 id="page-title">–î–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ üì¶</h1>
    <p id="page-subtitle">–í–µ—Ä—Å–∏—è ‚Äî</p>

    <div class="changelog" id="changelog">
      <h2>–ß—Ç–æ –Ω–æ–≤–æ–≥–æ</h2>
      <ul class="list" id="main-list"><!-- —Ä–µ–Ω–¥–µ—Ä —Å–≤–µ–∂–∏—Ö —Ä–µ–ª–∏–∑–æ–≤ --></ul>
    </div>

    <a class="download-btn" id="download-link" href="https://apk-download-gamma.vercel.app/app-release.apk" download>
      ‚¨á –°–∫–∞—á–∞—Ç—å APK
    </a>

    <footer>MgsINC ¬© <span id="year"></span></footer>
  </div>

  <!-- –ò—Å—Ç–æ—Ä–∏—è -->
  <aside class="versions-panel">
    <h2 onclick="toggleHistory()">üìú –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π</h2>
    <div id="history-list" class="collapsed"><!-- —Ä–µ–Ω–¥–µ—Ä —Å—Ç–∞—Ä—ã—Ö —Ä–µ–ª–∏–∑–æ–≤ --></div>
  </aside>

  <!-- –ö–Ω–æ–ø–∫–∞ –∏ –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
  <button class="gear" id="gear" title="–û—Ç–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å">‚öôÔ∏è</button>
  <div class="admin-panel" id="admin">
    <h3>–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–ª–∏–∑</h3>
    <div class="row">
      <div>
        <label>–í–µ—Ä—Å–∏—è</label>
        <input id="v-version" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, 1.3.1" />
      </div>
      <div>
        <label>–î–∞—Ç–∞</label>
        <input id="v-date" type="date" />
      </div>
    </div>
    <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫/—Ç–∏–ø (–Ω–∞–ø—Ä–∏–º–µ—Ä: Hotfix, –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞)</label>
    <input id="v-title" placeholder="Hotfix / –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞" />

    <label>–ü—É–Ω–∫—Ç—ã (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É)</label>
    <textarea id="v-items" rows="6" placeholder="üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ...\nüñ®Ô∏è –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è ‚Äî –ø–µ—á–∞—Ç—å..."></textarea>

    <div class="row">
      <div>
        <label>–°–≤–µ–∂–∏—Ö —Ä–µ–ª–∏–∑–æ–≤ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π</label>
        <select id="v-on-main">
          <option value="1">1</option><option value="2" selected>2</option>
          <option value="3">3</option><option value="4">4</option>
        </select>
      </div>
      <div>
        <label>–°—Å—ã–ª–∫–∞ –Ω–∞ APK (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
        <input id="v-apk" placeholder="https://..." />
      </div>
    </div>

    <div class="admin-actions">
      <button class="btn" id="publish">üìù –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
      <button class="btn secondary" id="copy-main">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å HTML ¬´–ß—Ç–æ –Ω–æ–≤–æ–≥–æ¬ª</button>
      <button class="btn secondary" id="copy-history">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å HTML ¬´–ò—Å—Ç–æ—Ä–∏—è¬ª</button>
      <button class="btn secondary" id="export">‚¨áÔ∏è –≠–∫—Å–ø–æ—Ä—Ç JSON</button>
      <button class="btn secondary" id="import">‚¨ÜÔ∏è –ò–º–ø–æ—Ä—Ç JSON</button>
      <button class="btn secondary" id="reset">üóë –°–±—Ä–æ—Å–∏—Ç—å (–æ—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë)</button>
    </div>
    <div class="small">–î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (localStorage). –ù–∞ Vercel –Ω–∏—á–µ–≥–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –Ω–µ –Ω—É–∂–Ω–æ.</div>
  </div>

  <script>
    // ====== –ú–û–î–ï–õ–¨ –î–ê–ù–ù–´–• ======
    const STORAGE_KEY = "skladsborka_changelog_v1";
    const DEFAULT_SHOW_ON_MAIN = 2;

    function todayISO(){
      const d = new Date();
      const tzOffset = d.getTimezoneOffset()*60000;
      return new Date(d - tzOffset).toISOString().slice(0,10);
    }

    const state = loadState() || seedInitial();

    function seedInitial(){
      // –ù–∞—á–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚Äî –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –∑–∞–º–µ–Ω–∏—Ç—å —Ç–≤–æ–∏–º–∏ —Ä–µ–ª–∏–∑–∞–º–∏.
      return {
        showOnMain: 2,
        apkUrl: "https://apk-download-gamma.vercel.app/app-release.apk",
        releases: [
          {
            version: "1.3.1",
            date: "2025-10-20",
            title: "Hotfix",
            items: [
              "üîß –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Ä–µ–∂–∏–º–æ–≤ <b>¬´–∫–∞—Ä–∞–Ω–¥–∞—à¬ª / ¬´–ø—Ä–∏–±–ª–∏–∑–∏—Ç—å¬ª</b> –≤—Å–ø–ª—ã–≤–∞—é—â–∏–µ –æ–∫–Ω–∞ <b>–±–æ–ª—å—à–µ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è</b>.",
              "üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–¥–∞—á–∏ ‚Äî —Ç–µ–ø–µ—Ä—å <b>–∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞ –≤—Å—è –æ–±–ª–∞—Å—Ç—å</b>.",
              "üóÉÔ∏è <b>–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∞—Ä—Ö–∏–≤–∞—Ü–∏—è</b> —Å—Ç–∞—Ä—ã—Ö –∑–∞–¥–∞—á.",
              "üñºÔ∏è –î–æ–±–∞–≤–ª–µ–Ω–∞ <b>–∏–Ω–¥–∏–∫–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</b> –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∑–∞–¥–∞—á–∏.",
              "üñ®Ô∏è <b>–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è:</b> –ø–µ—á–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è/—Ñ–∞–π–ª–∞ –ø—Ä—è–º–æ –∏–∑ –∑–∞–¥–∞—á–∏."
            ]
          },
          {
            version: "1.2",
            date: "2025-10-12",
            title: "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞",
            items: [
              "üì¢ –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ ‚Äî <b>–≤–µ—Ä—Ö–Ω–∏–π –±–∞–Ω–Ω–µ—Ä</b> —Å –∫–Ω–æ–ø–∫–æ–π ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª. –ï—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –µ—Å—Ç—å <b>–∑–∞–ø–∞—Å–Ω–∞—è</b> ‚Äî –≤–µ–¥—ë—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.",
              "üì∑ –í —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ <b>¬´–°–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ¬ª</b>.",
              "üì≤ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚Äî –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è <b>–Ω—É–∂–Ω–∞—è –∑–∞–¥–∞—á–∞</b>.",
              "üóÑÔ∏è <b>–ê—Ä—Ö–∏–≤–∞—Ü–∏—è –∏ –æ—á–∏—Å—Ç–∫–∞</b> –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á (—Ä–µ–∂–∏–º <i>–ù–∞—á–∞–ª—å–Ω–∏–∫</i>).",
              "üî¢ –ù–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ –∫–ª–∞–¥–æ–≤—â–∏–∫–∞ –ø–æ–¥ –∫–Ω–æ–ø–∫–∞–º–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è <b>–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á</b> ‚Äî –≤–∏–¥–Ω–æ –±–µ–∑ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ —Ä–∞–∑–¥–µ–ª.",
              "üö™ –ö–Ω–æ–ø–∫–∞ <b>¬´–í—ã—Ö–æ–¥¬ª</b> –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ –Ω–∏–∂–Ω—é—é —á–∞—Å—Ç—å –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞."
            ]
          },
          {
            version: "20.10",
            date: "2025-10-10",
            title: "HotFix",
            items: [
              "üë∑‚Äç‚ôÇÔ∏è <b>–î–ª—è –∫–ª–∞–¥–æ–≤—â–∏–∫–∞:</b> –∫–Ω–æ–ø–∫–∞ ¬´–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á¬ª, ‚è±Ô∏è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤—Ä–µ–º–µ–Ω–∏, ‚ö†Ô∏è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–µ—Ç–∏.",
              "üë®‚Äçüíº <b>–î–ª—è –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞:</b> –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–∞–º–æ–≤—ã–≤–æ–∑–∞—Ö.",
              "üåê <b>–î–ª—è –≤—Å–µ—Ö:</b> –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è ‚Äî üü¢ ¬´–í —Å–µ—Ç–∏¬ª, üü° ¬´–ü–ª–æ—Ö–∞—è —Å–≤—è–∑—å¬ª; üì° —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–ø–∏—Å–∫–∏; üö´ –±–∞–Ω–Ω–µ—Ä –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.",
              "üñºÔ∏è –ü—Ä–æ–ª–∏—Å—Ç—ã–≤–∞–Ω–∏–µ —Ñ–æ—Ç–æ –≤ –ø—Ä–µ–≤—å—é –∑–∞–¥–∞—á.",
              "‚è∞ –ü–æ–∫–∞–∑ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–∑–¥–∞–Ω–∏—è/—Å—Ç–∞—Ä—Ç–∞/–∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏.",
              "üíº <b>–î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞:</b> –æ–±—Ä–∞—Ç–Ω—ã–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö."
            ]
          }
        ]
      };
    }

    function loadState(){
      try{ return JSON.parse(localStorage.getItem(STORAGE_KEY)); }catch(e){ return null; }
    }
    function saveState(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    // ====== –†–ï–ù–î–ï–† ======
    function render(){
      // –•–µ–¥–µ—Ä
      const year = document.getElementById("year");
      year.textContent = new Date().getFullYear();

      const mainList = document.getElementById("main-list");
      const history = document.getElementById("history-list");
      mainList.innerHTML = ""; history.innerHTML = "";

      // —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
      const releases = [...state.releases].sort((a,b)=> (b.date||"").localeCompare(a.date||""));

      // –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      if (releases.length){
        document.getElementById("page-subtitle").textContent =
          `–í–µ—Ä—Å–∏—è ${releases[0].version} –æ—Ç ${formatDate(releases[0].date)}`;
      }

      // APK —Å—Å—ã–ª–∫–∞
      document.getElementById("download-link").href = state.apkUrl || "https://apk-download-gamma.vercel.app/app-release.apk";

      // —Å–∫–æ–ª—å–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
      const n = Number(state.showOnMain || DEFAULT_SHOW_ON_MAIN);

      releases.forEach((rel, idx)=>{
        const block = releaseToMainBlock(rel);
        if (idx < n) {
          mainList.appendChild(block);
        } else {
          history.appendChild(releaseToHistoryBlock(rel));
        }
      });
    }

    function releaseToMainBlock(rel){
      const li = document.createElement("li");
      li.innerHTML = `
        <span class="title">üÜï –í–µ—Ä—Å–∏—è ${escapeHTML(rel.version)} ‚Äî ${escapeHTML(rel.title||"–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ")}</span>
        <ul class="sub">
          ${rel.items.map(s=>`<li>${s}</li>`).join("")}
        </ul>`;
      return li;
    }

    function releaseToHistoryBlock(rel){
      const wrap = document.createElement("div");
      wrap.className = "old-version";
      wrap.innerHTML = `
        <strong>–í–µ—Ä—Å–∏—è ${escapeHTML(rel.version)} ‚Äî ${formatDate(rel.date)}</strong>
        <ul>
          ${rel.items.map(s=>`<li>${s}</li>`).join("")}
        </ul>`;
      return wrap;
    }

    function formatDate(iso){
      if (!iso) return "";
      const [y,m,d] = iso.split("-");
      return `${Number(d)} ${ruMonth(m)} ${y}`;
    }
    function ruMonth(m){
      const map = {
        "01":"—è–Ω–≤–∞—Ä—è","02":"—Ñ–µ–≤—Ä–∞–ª—è","03":"–º–∞—Ä—Ç–∞","04":"–∞–ø—Ä–µ–ª—è","05":"–º–∞—è","06":"–∏—é–Ω—è",
        "07":"–∏—é–ª—è","08":"–∞–≤–≥—É—Å—Ç–∞","09":"—Å–µ–Ω—Ç—è–±—Ä—è","10":"–æ–∫—Ç—è–±—Ä—è","11":"–Ω–æ—è–±—Ä—è","12":"–¥–µ–∫–∞–±—Ä—è"
      };
      return map[m] || m;
    }
    function escapeHTML(s){ return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

    // ====== –ê–î–ú–ò–ù ======
    const gear = document.getElementById("gear");
    const admin = document.getElementById("admin");
    gear.addEventListener("click", ()=> {
      admin.style.display = (admin.style.display==="block"?"none":"block");
      // –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É –µ—Å–ª–∏ –ø—É—Å—Ç–æ
      const dateEl = document.getElementById("v-date");
      if(!dateEl.value) dateEl.value = todayISO();
      // –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Å–µ–ª–µ–∫—Ç –∏ —Å—Å—ã–ª–∫—É –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é
      document.getElementById("v-on-main").value = String(state.showOnMain || DEFAULT_SHOW_ON_MAIN);
      document.getElementById("v-apk").value = state.apkUrl || "";
    });

    document.getElementById("publish").addEventListener("click", ()=>{
      const version = document.getElementById("v-version").value.trim();
      const date = document.getElementById("v-date").value || todayISO();
      const title = document.getElementById("v-title").value.trim() || "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ";
      const itemsRaw = document.getElementById("v-items").value.trim();
      const showOnMain = Number(document.getElementById("v-on-main").value || DEFAULT_SHOW_ON_MAIN);
      const apk = document.getElementById("v-apk").value.trim();

      if (!version || !itemsRaw){
        alert("–£–∫–∞–∂–∏ –≤–µ—Ä—Å–∏—é –∏ –ø—É–Ω–∫—Ç—ã —Ä–µ–ª–∏–∑–∞ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É).");
        return;
      }
      const items = itemsRaw.split(/\r?\n/).filter(Boolean).map(line => line.trim());

      // –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–ª–∏–∑
      state.releases.push({version, date, title, items});
      state.showOnMain = showOnMain;
      if (apk) state.apkUrl = apk;

      saveState(); render();
      // –æ—á–∏—Å—Ç–∏–º –≤–≤–æ–¥ —Ç–æ–ª—å–∫–æ –ø—É–Ω–∫—Ç—ã/–∑–∞–≥–æ–ª–æ–≤–æ–∫/–≤–µ—Ä—Å–∏—é (–¥–∞—Ç—É –æ—Å—Ç–∞–≤–∏–º)
      document.getElementById("v-version").value = "";
      document.getElementById("v-title").value = "";
      document.getElementById("v-items").value = "";
    });

    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ HTML –±–ª–æ–∫–æ–≤ (–¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –Ω–∞ —Ç–≤–æ—é —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É)
    function copyHTML(selector){
      const node = document.querySelector(selector);
      const html = node.innerHTML.trim();
      navigator.clipboard.writeText(html).then(()=> alert("HTML —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞"));
    }
    document.getElementById("copy-main").addEventListener("click", ()=> copyHTML("#main-list"));
    document.getElementById("copy-history").addEventListener("click", ()=> copyHTML("#history-list"));

    // –ò–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç
    document.getElementById("export").addEventListener("click", ()=>{
      const blob = new Blob([JSON.stringify(state,null,2)], {type:"application/json"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "changelog.json";
      a.click();
      URL.revokeObjectURL(a.href);
    });
    document.getElementById("import").addEventListener("click", async ()=>{
      const input = document.createElement("input");
      input.type = "file"; input.accept = "application/json";
      input.onchange = async () => {
        const file = input.files[0]; if(!file) return;
        const text = await file.text();
        try{
          const obj = JSON.parse(text);
          if (!obj.releases) throw new Error("–ù–µ—Ç –ø–æ–ª—è releases");
          state.releases = obj.releases;
          state.showOnMain = obj.showOnMain || DEFAULT_SHOW_ON_MAIN;
          state.apkUrl = obj.apkUrl || state.apkUrl;
          saveState(); render();
        }catch(e){ alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å JSON: "+e.message); }
      };
      input.click();
    });

    document.getElementById("reset").addEventListener("click", ()=>{
      if (confirm("–¢–æ—á–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Ä–µ–ª–∏–∑—ã? –≠—Ç–æ —É–¥–∞–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.")){
        localStorage.removeItem(STORAGE_KEY);
        location.reload();
      }
    });

    function toggleHistory(){
      document.getElementById("history-list").classList.toggle("collapsed");
    }
    window.toggleHistory = toggleHistory;

    // –ü–µ—Ä–≤–∏—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    render();
  </script>
</body>
</html>
