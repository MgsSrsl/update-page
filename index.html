<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Обновления — Складсборка</title>
  <style>
    :root{
      --bg:#0b0d10; --card:#12161b; --muted:#a6b0bf; --text:#e8eef7; --brand:#ff3b30;
      --sep:rgba(255,255,255,.08);
    }
    *{box-sizing:border-box} body{margin:0;background:linear-gradient(180deg,#0b0d10,#0e1318);
      color:var(--text);font:16px/1.45 system-ui, -apple-system, "Segoe UI", Roboto, Arial}
    a{color:#9dc1ff;text-decoration:none} a:hover{text-decoration:underline}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    .grid{display:grid;grid-template-columns:2fr 1fr;gap:20px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card);border:1px solid var(--sep);border-radius:16px;box-shadow:0 6px 30px rgba(0,0,0,.25)}
    .hero{padding:22px 22px 10px}
    .hero h1{margin:0 0 6px;font-size:28px}
    .meta{display:flex;gap:10px;flex-wrap:wrap;color:var(--muted);font-size:14px}
    .chips{display:flex;gap:8px;margin:10px 0 14px}
    .chip{font-size:12px;padding:4px 8px;border-radius:999px;background:#1b222b;color:#cfe1ff;border:1px solid var(--sep)}
    .content{padding:0 22px 18px}
    .content ul{margin:0 0 8px 18px}
    .dl{display:flex;gap:12px;flex-wrap:wrap;margin-top:8px}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid var(--sep);
      background:#1a2430;color:#eaf2ff;text-decoration:none;font-weight:600}
    .btn svg{width:18px;height:18px}
    .side{display:flex;flex-direction:column;gap:12px}
    .side .title{font-weight:700;font-size:14px;color:#cbd5e1;letter-spacing:.02em;margin:0 8px}
    .acc{border-radius:14px;overflow:hidden;border:1px solid var(--sep);background:#11161c}
    .accBtn{all:unset;display:flex;justify-content:space-between;align-items:center;width:100%;
      padding:12px 14px;cursor:pointer}
    .accBtn:hover{background:#141a21}
    .accBtn h3{margin:0;font-size:15px}
    .accBtn .small{color:var(--muted);font-size:12px}
    .accPanel{max-height:0;overflow:hidden;transition:max-height .25s ease}
    .accPanel.open{max-height:420px}
    .accPanel .pad{padding:0 14px 14px}
    .sep{height:1px;background:var(--sep);margin:10px 0}
    .foot{margin-top:32px;color:var(--muted);font-size:13px;text-align:center}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="grid">
      <!-- Left: Latest release will be injected here -->
      <div id="latest"></div>

      <!-- Right: Older releases as collapsible items -->
      <aside class="side">
        <p class="title">Предыдущие версии</p>
        <div id="older"></div>
      </aside>
    </div>

    <p class="foot">MgsINC © <span id="year"></span></p>
  </div>

  <script>
    // ====== ДАННЫЕ ПРО ОБНОВЛЕНИЯ ======
    // Первый элемент считается «последним» и показывается крупно.
    const releases = [
      {
        version: "1.1",
        date: "2025-10-08",         // YYYY-MM-DD (удобно для сортировки)
        title: "Доступно обновление",
        bullets: [
          "✅ Внесены изменения в дизайн карточек и фона, мелкие визуальные правки.",
          "Поддержка старых версий Android (возможна некорректная работа на части устройств).",
          "⚙️ Сортировщики задач: при «Взять в работу» задача закрепляется за кладовщиком.",
          "Редактор изображения в задаче — можно помечать на фото позиции.",
          "Информация о новой версии и ссылке на скачивание приходит каждому пользователю в заданиях.",
          "Мелкие исправления интерфейса и оптимизация кода."
        ],
        apkUrl: "https://apk-download-gamma.vercel.app"
      },
      // Примеры прошлых версий (добавляй сюда по мере выхода новых)
      {
        version: "1.0.5",
        date: "2025-09-24",
        bullets: [
          "Стабильность: фикс падения при открытии изображений.",
          "Ускорена подгрузка списка задач."
        ]
      },
      {
        version: "1.0.4",
        date: "2025-09-12",
        bullets: [
          "Добавлены уведомления о новых задачах.",
          "Мелкие улучшения UI."
        ]
      }
    ];

    // ====== РЕНДЕР ======
    const $latest = document.getElementById("latest");
    const $older  = document.getElementById("older");
    const fmt = (iso) => {
      try{
        const d = new Date(iso+"T00:00:00");
        return d.toLocaleDateString("ru-RU",{day:"2-digit",month:"long",year:"numeric"});
      }catch{ return iso }
    };

    function renderLatest(r){
      const chips = [
        `<span class="chip">Версия ${r.version}</span>`,
        `<span class="chip">${fmt(r.date)}</span>`
      ].join("");

      const bullets = (r.bullets||[]).map(b=>`<li>${b}</li>`).join("");

      $latest.innerHTML = `
        <article class="card">
          <div class="hero">
            <h1>${r.title || "Что нового"}</h1>
            <div class="meta">
              <div class="chips">${chips}</div>
            </div>
          </div>
          <div class="content">
            <ul>${bullets}</ul>
            <div class="dl">
              ${r.apkUrl ? `<a class="btn" href="${r.apkUrl}">
                <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                  <path d="M5 20h14v-2H5v2zm7-18-5.5 5.5 1.41 1.41L11 6.83V16h2V6.83l3.09 3.08 1.41-1.41L12 2z"/>
                </svg> Скачать APK
              </a>`:``}
            </div>
          </div>
        </article>
      `;
    }

    function renderOlder(list){
      $older.innerHTML = list.map((r,i)=>`
        <section class="acc">
          <button class="accBtn" aria-expanded="false">
            <h3>Версия ${r.version}</h3>
            <span class="small">${fmt(r.date)}</span>
          </button>
          <div class="accPanel" id="panel-${i}">
            <div class="sep"></div>
            <div class="pad">
              <ul>${(r.bullets||[]).map(b=>`<li>${b}</li>`).join("")}</ul>
              ${r.apkUrl?`<div class="sep"></div>
                <a class="btn" href="${r.apkUrl}">Скачать APK</a>`:""}
            </div>
          </div>
        </section>
      `).join("");

      // Аккордеон
      $older.querySelectorAll(".accBtn").forEach((btn, idx)=>{
        const panel = document.getElementById(`panel-${idx}`);
        btn.addEventListener("click", ()=>{
          const isOpen = panel.classList.toggle("open");
          btn.setAttribute("aria-expanded", String(isOpen));
        });
      });
    }

    // Гарантируем, что самый свежий — первый (вдруг забудешь порядок)
    releases.sort((a,b)=> (b.date>a.date?1:-1));

    renderLatest(releases[0]);
    renderOlder(releases.slice(1));
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>
</body>
</html>
